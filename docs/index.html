<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Receiver · Dev Overlay</title>
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
  <style>
    html,body,a-scene{width:100%;height:100%;margin:0;background:#000}
    #hud{position:fixed;top:10px;left:10px;color:#fff;font:14px/1.4 system-ui}
    #hud code{background:#111;padding:2px 6px;border-radius:6px}
    video{display:none}
  </style>
</head>
<body>
  <div id="hud">
    Receiver ID: <code id="rid">gerando…</code><br>
    Abra o <b>Sender</b> e informe esse ID.
  </div>

  <a-scene
    embedded
    renderer="alpha:true; colorManagement:true"
    xr-mode="ar"
    vr-mode-ui="enabled:true"
    webxr="optionalFeatures: hit-test, dom-overlay"
    dev-overlay
  >
    <a-assets>
      <video id="remoteVideo" autoplay muted playsinline crossorigin="anonymous"></video>
      <video id="passVideo"  autoplay muted playsinline crossorigin="anonymous"></video>
    </a-assets>

    <a-entity camera position="0 1.6 0"></a-entity>
  </a-scene>

  <!-- seu componente (sem alterações) -->
  <script src="dev-overlay.js"></script>

  <script>
    // Receiver via PeerJS Cloud
    const peer = new Peer(undefined, { debug: 2 }); // usa PeerServer Cloud padrão (0.peerjs.com)
    const ridEl = document.getElementById('rid');
    const remoteVideo = document.getElementById('remoteVideo');

    // ID aleatório gerado pelo servidor da PeerJS Cloud
    peer.on('open', id => { ridEl.textContent = id; });

    // Recebe chamada e responde sem mídia local (só recebe vídeo)
    peer.on('call', call => {
      call.answer(null);
      call.on('stream', stream => {
        remoteVideo.srcObject = stream;
        remoteVideo.onloadedmetadata = () => remoteVideo.play();
      });
    });

    peer.on('error', e => console.warn('[peer:error]', e));
  </script>
</body>
</html>
